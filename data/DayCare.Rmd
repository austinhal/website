---
title: "Day Care Fines"
output: 
  html_document:
    theme: flatly
    code_folding: hide
---

<script type="text/javascript">
 function showhide(id) {
    var e = document.getElementById(id);
    e.style.display = (e.style.display == 'block') ? 'none' : 'block';
 }
</script>

```{r, include=FALSE}
library(mosaic)
library(DT)
library(pander)
library(car)

# To get the "late" dataset into your R Console, 
# you need to go to your file menu of R-Studio and select
# "Session, Set working directory, To source file location"
# Then click the green "play" arrow in 
# the top right corner of this gray R-Chunk. 
late <- read.csv("../Data/late.csv", header=TRUE)
# Then type:
# > View(late)
# in your R Console
```



----

<!--If you want to give your critiquers some ideas about what you have questions on and would like help with, place those details here.-->

**Comments to Critiquers:** 



<!--End your comments to your critiquers before this line.-->

----


## Background {.tabset .tabset-fade}

### Overview
<!-- Be sure to add your own background here before beginning the Analysis. -->

<p><font size=5>**Summary of Study**</font></p>

<p align="justify">
Tardiness is not a habit isolated to one country. Much has been done in the way of trying to reduce `late` behavior. In the following study, we examine the behavior of parents who have their children enrolled across several day care facilities. Particularly, we are trying to observe the effects of the implementation of a fine at a select handful of these facilities will reduce the number of children picked up late.</p>

During the study, *6 of the 10 daycare centers* implemented a fine to parents who came after 4:00pm. 

The study lasted for a total of 20 weeks. The first `4 weeks` was simple observation. *What number of parents arrived late each week?* Once that baseline was established, at the beginning of the `5th week`, a fine was introduced at `6 of the 10` daycare centers. At the beginning of the `17th week`, the fine was removed. From that point forward, there was just simple recording of who came late, even though there was now no fine.

With the background of the study in mind, we ask the following:

<p><font size=5>**Question**</font></p>

<p align="center"><font size=4><i>#1 Does the number of late parents change with the addition of a fine? In other words, does the group the parent belongs to affect if they will be late or not? <br><br>#2 Does the period (when the fine was introduced and removed) affect the number of parents arriving late?<br><br>#3 Does the change in period for whether or not the parent is fined have an effect. In other words, is there an effect between period and group?</i></font></p>

---

<center>
<p align ="center">
<strong>Null Hypothesis</strong></p>

$$
H_0 1: \alpha_\text{Fined Group} = \alpha_\text{Control Group}
$$
$$
H_0 2: \beta_\text{Pre-fine period} = \beta_\text{During-fine period} = \beta_\text{Post-fine period}  
$$

$H_0 3$: The effect of each period is the same for both groups

---

<center>
<strong>Alternative Hypothesis</strong>
$$
H_a 1: \alpha_\text{Fined Group} \neq \alpha_\text{Control Group}
$$
$$
H_a 2: \beta_\text{Pre-fine period} \neq \beta_\text{During-fine period} \neq \beta_\text{Post-fine period}  
$$

$H_a 3$: The effect of each period is not the same for both groups

<!--End your background before here.-->
<!--Click the little black arrow to 
the left to expand/hide these next sections.-->
### Study Details

<div style="color:#a8a8a8;">
This background is quoted directly from the article ["A Fine is a Price"](http://rady.ucsd.edu/faculty/directory/gneezy/pub/docs/fine.pdf). 
</div>

<div style="padding-left:30px; padding-right:30px;">

There are two types of day-care centers in Israel: private and public. A study was conducted in 10 private day-care centers in the city of Haifa from January to June 1998. All of these centers are located in the same part of town, and there is no important difference among them. During the day children are organized into groups according to age, from 1 to 4 years old. Each day-care center is allowed to hold a maximum of 35 children. In some exceptional cases a few additional children are allowed. The fee for each child is NIS 1,400 per month. (The NIS is the New Israeli Shekel.) At the time of the study, a U.S. dollar was worth approximately NIS 3.68, so the fee was about $380 at that time. 

The contract signed at the beginning of the year states that the day-care
center operates between 0730 and 1600. There is no mention of what happens if parents come late to pick up their children. In particular, before the beginning of the study, there was no fine for coming late. When parents did not come on time, one of the teachers had to wait with the children concerned. Teachers would rotate in this task, which is considered part of the job of a teacher, a fact that is clearly explained when a teacher is hired. Parents rarely came after 1630. 

A natural option [to fix the problem of parents showing up late] is to introduce a fine: every time a parent comes late, [they] will have to pay a fine. Will that reduce the number of parents who come late? If the fine is removed, will things revert back to the way they were originally?

The overall period of the study was 20 weeks. In the first 4 weeks we
simply recorded the number of parents who arrived late each week. At the
beginning of the fifth week, we introduced a fine in six of the 10 day-care centers, which had been selected randomly. The announcement of the fine was made with a note posted on the bulletin board of the day-care center. Parents tend to look at this board every day, since important announcements are posted there. The announcement specified that the fine would be NIS 10 for a delay of 10 minutes or more. The fine was per child; thus, if parents had two children in the center and they came late, they had to pay NIS 20. Payment was made to the principal of the day-care center at the end of the month. Since monthly payments are made to the owner during the year, the fines were added to those amounts. The money was paid to the owner, rather then to the teacher who was staying late (and did not get any additional money). The teachers were informed of the fine but not of the study. Registering the names of parents who came late was a common practice in any case.

At the beginning of the seventeenth week, the fine was removed with no explanation. Notice of the cancellation was posted on the board. If parents asked why the fines were removed, the principals were instructed to reply that the fine had been a trial for a limited time and that the results of this trial were now being evaluated.

A comparison with other fines in Israel may give an idea of the size of
the penalty that was introduced. A fine of NIS 10 is relatively small but not insignificant. In comparison, the fine for illegal parking is NIS 75; the fine for driving through a red light is NIS 1,000 plus penalties; the fine for not collecting the droppings of a dog is NIS 360. For many of these violations, however, detection and enforcement are low or, as in the case of dog dirt, nonexistent in practice. A baby-sitter earns between NIS 15 and NIS 20 per hour. The average gross salary per month in Israel at the time of the study was NIS 5,595.

</div>


### The Data (Wide)


The `late` Day Care Center data is shown here in the "wide data format". 

```{r, out.width=300}
#Show the full width of the "Wide" version of the late data:
pander(late, split.tables = Inf)
```


### The Data (Long)

The `Late` Day Care Center data is shown here in the "long data format".

```{r}
# This code reshapes the data into "long" format called Late.
# To get the "Late" dataset into your R Console, 
# you need to click the green "play" arrow in 
# the top right corner of this gray R-Chunk. 
# Then type:
#   > View(Late)
# in your R Console
Late <- reshape(late,
                varying = paste("Week",1:20, sep=""), 
                v.names = "No.ofLateChildren",
                timevar = "Week", 
                times = 1:20, 
                idvar = "Center",
                new.row.names = 1:200,
                direction = "long")
pander(Late)

Late$Period <- cut(Late$Week, c(0,4,16,20), labels=c("PreFine","FinePeriod","PostFine"))
```


 
##  
<!-- You can begin writing again after here.-->



## Data Analysis

To conduct this ANOVA test, we first needed to create a new column in which we could indicate the period for the duration of the experiment. The control group will be indicated by these periods as well, but will not receive a fine from each period. The first period, pre-fine, is weeks one through four. The second period, the fine period, is weeks five through sixteen, and the third period, the post-fine period, is weeks seventeen through twenty. The `Fined Group` will be fined only during the second period according to the rules established in study. After the study, the number of parents that arrived late was recorded and is displayed in the table below.

The `late` daycare data that we have conducted our tests from is shown below in "wide" format.

```{r}
datatable(late, options=list(lengthMenu = c(10,20)), extensions = "Responsive")
#pander(late, split.tables = Inf, responsive = TRUE)
```


Our questions leave us needing to conduct a Two-way ANOVA test. In order to do so, we need to make sure that our data will allow to conduct this test. We need to first, check the errors of the data are normally distributed and our variance errors should be constant.

```{r fig.height=6, fig.width=10, message=FALSE, warning=FALSE}
long.aov <- aov(No.ofLateChildren ~ Treatment * Period, data = Late, id = FALSE)
par(mfrow=c(1,2))
plot(long.aov, which = 1:2, pch=16)
```

Using the graph on the left, we can assume the constant variance is fulfilled. There is some variance within our graph, but we can still proceed with our ANOVA test. With our graph of the right, are values are within close enough limits that we can continue with our test.

Now that we have checked to make sure that we can conduct the ANOVA test, we will proceed to check our Hypothesis.

```{r}
pander(summary(long.aov))
```

```{r fig.width=10}
xyplot(No.ofLateChildren ~ Treatment, 
       data = Late, 
       type = c("p","a"),
       main = "The effects between groups",
       ylab = "# of late parents",
       col  = "darkblue")
```

From our first test, we see that our P-value for our treatment (or our groups) is less than 0.05, we have sufficient evidence to reject the null hypothesis. We accept that one group has significantly more late parent arrivals than the other. We can conclude that the `"fine"` group has more late parent arrivals.

```{r fig.width=10}
xyplot(No.ofLateChildren ~ Period, 
       data = Late, 
       type = c("p","a"), 
       main = "The effects between different periods", 
       ylab = "# of late parents", 
       col  = "darkred")
```

To answer this second question, we are going to look at the P-Value from the Period row. We can see that our P-value is less than 0.05. With this, we will accept our alternative hypothesis which is that at least one period has different amount of late parents than the other. Looking at our chart, we can assume that the `"FinePeriod"` and `"PostFine"` period have more late parents than the `"PreFine"` period. We can assume that as time goes on, the number of late parents increases with the type of period.

```{r fig.width=10}
xyplot(No.ofLateChildren ~ Period,
       groups = Treatment,
       data = Late,
       type = c("p","a"),
       main = "Effects and significnce of interaction between groups and periods",
       ylab = "# of late parents",
       auto.key = list(corner=c(1,1)))
```

Due to a p-value that is smaller than our alpha level of 0.05, we reject the null hypothesis and accept that the effects of period on the amount of late parents is not the same between the `Fine` group and the `Control` group. As we can see, there is a correlation between period and treatment groups. The `control` group continually goes down with each period, whereas the `fine` group only continually rises over time. Even after the fine was removed, the `fine` group continues to increase.

## Interpretation

As we can see from the data, once the fine has been added, the instance of late parents increases dramatically. During the first period, we could have assumed that the control group was more apt to have late parents since it started higher. As time goes on, however, we can see that the fine had a huge impact on parents arriving late to pick up their children. This is very curious behavior. Most would assume that having a fine would deter parents from arriving late, however, factors we cannot see have influenced them to arrive more late than the group that did not receive a fine. 

Looking at the chart below, we can see strikingly that by week 9, the average was 20 late parents. That's more than half of the total capacity of any daycare center. 

```{r include=FALSE}
ave_late <- Late %>% 
  group_by(Treatment, Week) %>% 
  mutate(average = mean(No.ofLateChildren)) %>% 
  select(Treatment, Week, average) 
```

```{r fig.width=10}
ave_late %>% 
  ggplot(aes(x = Week, y = average, group = Treatment, color = Treatment)) +
  geom_point(aes(Week, average),
             size = 3) +
  geom_line(size = 1.2) +
  labs(title = "Average shows that fine group has higher occurance of late parents",
       y = "Average Number of Late Parents") +
  scale_color_brewer(palette = "Dark2") +
  theme_bw() +
  theme(legend.position = "bottom")
```

## Conclusion

Having a fine in this instance did not encourage parents to pick their children up early from daycare. The extra fine showed immediately that parents were alright paying a little extra to have someone watch their child for a little extra longer. Even after the fine was removed, parents were already used to being late and continued to take advantage of the situation. 

Perhaps parents were on time due to social politeness. They wanted to appear upstanding and prompt in the eyes of those who were watching their children. As with the `fine` group, this social norm turned business practice once the fine was introduced. Even after the fine was remove, parents still took advantage of being tardy.

There could be several other factors that influence parents from picking up their children that aren't included in this study. Perhaps their parents are both full time professionals and can't get the time off to pick up their child, or they simply choose not to pick their child up on time. Either way, from the data we see here, if a daycare center really wants parents to come on time, they shouldn't consider including a fine, or if they do, it should be much higher to discourage late behavior.

```{r include=FALSE}
par(mfrow=c(1,2))
boxplot(No.ofLateChildren ~ Treatment, data=Late, id.method="y",ylab = "Number of Late Children", xlab = "Treatment", main = "Fines equals more Late Children", col = "red")
boxplot(No.ofLateChildren ~ Period, data=Late, id.method="y", ylab = "Number of Late Children", xlab = "Period", main = "More Late Children Post Fine")
```


